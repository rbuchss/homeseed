#!/usr/bin/env ruby

require_relative '../lib/homeseed'
require 'thor'

module Homeseed
  class HomeseedCliApp < Thor
    desc 'exec [-s <servers>] [-e <command> or -f <files>] [-u <user>]', 'exec in line bash commands or bash commands from yml file on remote server'
    method_option :servers, required: true, aliases: '-s', desc: 'ssh hostname(s)'
    method_option :command, aliases: '-e', desc: 'bash command to exec'
    method_option :files, aliases: '-f', desc: 'yml command file(s) to exec'
    method_option :user, aliases: '-u', desc: 'ssh username', default: ENV['USER']
    def exec
      connection = Homeseed::Connection.new options
      connection.ssh_exec
    end
  end
  HomeseedCliApp.start
end
